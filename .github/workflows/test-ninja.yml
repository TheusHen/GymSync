name: GymSync Ninja Build Test

on: [push, pull_request]

jobs:
  test_ninja:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      - name: Set up Flutter
        uses: subosito/flutter-action@v2
        with:
          flutter-version: '3.22.1'
          architecture: x64

      - name: Set up Node.js
        uses: actions/setup-node@v3
        with:
          node-version: '18'

      - name: Verify environments
        run: |
          echo "Flutter version:"
          flutter --version
          echo "Dart version:"
          dart --version
          echo "Node version:"
          node --version
          echo "NPM version:"
          npm --version

      - name: Install Ninja
        run: sudo apt-get install ninja-build -y

      - name: Check current working directory
        run: |
          echo "Current working directory:"
          pwd

      - name: List repo files
        run: |
          echo "Repository content:"
          ls -la

      - name: Find all build.ninja files
        run: |
          echo "Looking for all build.ninja files:"
          find . -name build.ninja

      - name: Confirm build.ninja content
        run: |
          echo "Showing first 20 lines of build.ninja:"
          head -n 20 build.ninja

      - name: Run Ninja build
        run: ninja -v
        working-directory: ${{ github.workspace }}
